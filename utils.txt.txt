this is the utility function version 3
